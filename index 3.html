<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gieo Qu·∫ª Kinh D·ªãch</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-center p-4">
  <div class="bg-white shadow-lg rounded-2xl w-full max-w-xl p-6">
    <h1 class="text-2xl font-semibold text-center mb-4">üîÆ Gieo Qu·∫ª Kinh D·ªãch</h1>

    <button id="castButton" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-xl transition-all">Gieo Qu·∫ª</button>

    <p id="loading" class="text-center mt-4 text-gray-600 hidden">‚è≥ ƒêang gieo qu·∫ª...</p>
    <p id="limitMsg" class="text-center mt-4 text-red-500 hidden">‚ö†Ô∏è Vui l√≤ng tr·ªü l·∫°i v√†o ng√†y mai</p>

    <div id="result" class="mt-6 whitespace-pre-line text-gray-800"></div>
  </div>

  <script>
    const API_KEY = "AIzaSyBGQHZMHE7c6EniQJ8wIOZRug5iYRjfrMo";
    const castButton = document.getElementById("castButton");
    const resultDiv = document.getElementById("result");
    const loading = document.getElementById("loading");
    const limitMsg = document.getElementById("limitMsg");

    const prompt = `H√£y cho t√¥i m·ªôt qu·∫ª Kinh D·ªãch ng·∫´u nhi√™n t·ª´ h·ªá th·ªëng 64 qu·∫ª. Vui l√≤ng tr√¨nh b√†y r√µ r√†ng theo c√°c m·ª•c sau, v·ªõi n·ªôi dung ng·∫Øn g·ªçn, d·ªÖ hi·ªÉu cho m·ªói ph·∫ßn:\n\nT√™n qu·∫ª: (Bao g·ªìm H√°n t·ª± n·∫øu c√≥)\n\nH√¨nh qu·∫ª: (M√¥ t·∫£ Th∆∞·ª£ng qu√°i, H·∫° qu√°i v√† √Ω nghƒ©a c·ªßa ch√∫ng)\n\n√ù nghƒ©a chung c·ªßa qu·∫ª: (T√≥m t·∫Øt th√¥ng ƒëi·ªáp ch√≠nh)\n\n√ù nghƒ©a c√°c h√†o: (T√≥m t·∫Øt √Ω nghƒ©a t·ª´ng h√†o)\n\nL·ªùi khuy√™n ·ª©ng d·ª•ng trong ƒë·ªùi s·ªëng: (L·ªùi khuy√™n thi·∫øt th·ª±c, d·ªÖ √°p d·ª•ng)`;

    function hasCastToday() {
      const lastCast = localStorage.getItem("lastCastDate");
      const today = new Date().toISOString().split("T")[0];
      return lastCast === today;
    }

    function setCastToday() {
      const today = new Date().toISOString().split("T")[0];
      localStorage.setItem("lastCastDate", today);
    }

    async function gieoQue() {
      if (hasCastToday()) {
        limitMsg.classList.remove("hidden");
        return;
      }

      loading.classList.remove("hidden");
      resultDiv.innerText = "";
      limitMsg.classList.add("hidden");

      try {
        const res = await fetch(
          `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`,
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              contents: [{ parts: [{ text: prompt }] }],
            }),
          }
        );

        const data = await res.json();
        const output = data.candidates?.[0]?.content?.parts?.[0]?.text || "Kh√¥ng nh·∫≠n ƒë∆∞·ª£c k·∫øt qu·∫£.";
        resultDiv.innerText = output;
        setCastToday();
      } catch (error) {
        resultDiv.innerText = "ƒê√£ x·∫£y ra l·ªói khi g·ªçi API.";
      } finally {
        loading.classList.add("hidden");
      }
    }

    castButton.addEventListener("click", gieoQue);
  </script>
</body>
</html>